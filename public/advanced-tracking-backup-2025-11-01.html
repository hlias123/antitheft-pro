<!--
üõ°Ô∏è SECURE GUARDIAN - ADVANCED TRACKING SYSTEM
üìÖ Backup Created: November 1, 2025
üîí This is a backup copy of the advanced tracking system
üåê Original URL: http://localhost:8080/advanced-tracking.html
üì± Features: 
   - Live GPS tracking with real-time updates
   - Interactive map with device location
   - Security controls (lock, alarm, wipe)
   - Remote camera access
   - Movement analytics and patterns
   - Battery monitoring
   - Activity feed
   - Theft detection alerts
üíæ Backup Purpose: Preserve working version before modifications
-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Anti-Theft Tracking System - BACKUP 2025-11-01</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #0f172a;
            color: white;
            overflow-x: hidden;
        }

        .header {
            background: linear-gradient(135deg, #1e293b, #334155);
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
            position: relative;
            z-index: 1000;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.5rem;
            font-weight: 700;
        }

        .status-bar {
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .status-item {
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(255,255,255,0.1);
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 14px;
        }

        .status-online {
            color: #10b981;
        }

        .status-battery {
            color: #f59e0b;
        }

        .status-location {
            color: #3b82f6;
        }

        .main-container {
            display: grid;
            grid-template-columns: 1fr 350px;
            height: calc(100vh - 70px);
            gap: 0;
        }

        .map-section {
            position: relative;
            background: #1e293b;
        }

        .map-container {
            width: 100%;
            height: 100%;
            position: relative;
        }

        #map {
            width: 100%;
            height: 100%;
        }

        .map-controls {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .map-btn {
            background: rgba(15, 23, 42, 0.9);
            color: white;
            border: none;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.1);
        }

        .map-btn:hover {
            background: rgba(59, 130, 246, 0.8);
            transform: translateY(-2px);
        }

        .tracking-info {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background: rgba(15, 23, 42, 0.95);
            padding: 20px;
            border-radius: 12px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.1);
            min-width: 300px;
        }

        .control-panel {
            background: linear-gradient(180deg, #1e293b, #0f172a);
            padding: 20px;
            overflow-y: auto;
            border-left: 1px solid rgba(255,255,255,0.1);
        }

        .panel-section {
            margin-bottom: 30px;
        }

        .panel-title {
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 15px;
            color: #e2e8f0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .device-status {
            background: rgba(255,255,255,0.05);
            padding: 20px;
            border-radius: 12px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .status-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .status-card {
            background: rgba(255,255,255,0.08);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }

        .status-value {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .status-label {
            font-size: 12px;
            opacity: 0.7;
        }

        .battery-indicator {
            width: 100%;
            height: 8px;
            background: rgba(255,255,255,0.2);
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }

        .battery-fill {
            height: 100%;
            background: linear-gradient(90deg, #10b981, #34d399);
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        .battery-low {
            background: linear-gradient(90deg, #ef4444, #f87171);
        }

        .control-buttons {
            display: grid;
            gap: 12px;
        }

        .control-btn {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
            border: none;
            padding: 15px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            justify-content: center;
        }

        .control-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(59, 130, 246, 0.3);
        }

        .control-btn.danger {
            background: linear-gradient(135deg, #ef4444, #dc2626);
        }

        .control-btn.danger:hover {
            box-shadow: 0 10px 25px rgba(239, 68, 68, 0.3);
        }

        .control-btn.warning {
            background: linear-gradient(135deg, #f59e0b, #d97706);
        }

        .control-btn.success {
            background: linear-gradient(135deg, #10b981, #059669);
        }

        .camera-section {
            background: rgba(255,255,255,0.05);
            padding: 20px;
            border-radius: 12px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .camera-preview {
            width: 100%;
            height: 200px;
            background: #000;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
            position: relative;
            overflow: hidden;
        }

        .camera-placeholder {
            color: #64748b;
            font-size: 14px;
            text-align: center;
        }

        .camera-controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .live-feed {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .recording-indicator {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #ef4444;
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: 600;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .location-history {
            max-height: 200px;
            overflow-y: auto;
        }

        .location-item {
            background: rgba(255,255,255,0.05);
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .location-time {
            color: #64748b;
            font-size: 12px;
        }

        .alert-banner {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
            padding: 15px 20px;
            text-align: center;
            font-weight: 600;
            animation: slideDown 0.5s ease;
        }

        @keyframes slideDown {
            from { transform: translateY(-100%); }
            to { transform: translateY(0); }
        }

        @media (max-width: 1024px) {
            .main-container {
                grid-template-columns: 1fr;
                grid-template-rows: 60vh 1fr;
            }
            
            .control-panel {
                border-left: none;
                border-top: 1px solid rgba(255,255,255,0.1);
            }
        }
    </style>
</head>
<body>
    <!-- Alert Banner -->
    <div id="alertBanner" class="alert-banner" style="display: none;">
        üö® DEVICE THEFT DETECTED - TRACKING ACTIVATED
    </div>

    <!-- Header -->
    <div class="header">
        <div class="logo">
            üõ°Ô∏è <span>Advanced Anti-Theft System</span>
        </div>
        <div class="status-bar">
            <div class="status-item">
                <span class="status-online">‚óè</span>
                <span id="connectionStatus">ONLINE</span>
            </div>
            <div class="status-item">
                <span class="status-battery">üîã</span>
                <span id="batteryStatus">85%</span>
            </div>
            <div class="status-item">
                <span class="status-location">üìç</span>
                <span id="locationStatus">GPS ACTIVE</span>
            </div>
        </div>
    </div>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Map Section -->
        <div class="map-section">
            <div class="map-container">
                <div id="map"></div>
                
                <!-- Map Controls -->
                <div class="map-controls">
                    <button class="map-btn" onclick="centerOnDevice()">üìç Center on Device</button>
                    <button class="map-btn" onclick="toggleTracking()">üéØ Live Tracking</button>
                    <button class="map-btn" onclick="showRoute()">üõ£Ô∏è Show Route</button>
                    <button class="map-btn" onclick="satelliteView()">üõ∞Ô∏è Satellite View</button>
                </div>

                <!-- Tracking Info -->
                <div class="tracking-info">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <strong>üéØ Live Tracking</strong>
                        <span id="lastUpdate" style="font-size: 12px; opacity: 0.7;">Live</span>
                    </div>
                    <div id="coordinates">37.9755¬∞N, 23.7348¬∞E</div>
                    <div style="font-size: 12px; opacity: 0.7; margin-top: 8px;">
                        Speed: <span id="currentSpeed">0 km/h</span> | 
                        Accuracy: <span id="gpsAccuracy">¬±3m</span>
                    </div>
                    <div style="font-size: 12px; margin-top: 8px; padding: 8px; background: rgba(239,68,68,0.2); border-radius: 6px;">
                        ‚è±Ô∏è Time at location: <span id="timeAtLocation">0m 0s</span><br>
                        üë£ Steps taken: <span id="stepCount">0</span> | Distance: <span id="totalDistance">0m</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Control Panel -->
        <div class="control-panel">
            <!-- Device Status -->
            <div class="panel-section">
                <div class="panel-title">
                    üì± Device Status
                </div>
                <div class="device-status">
                    <div class="status-grid">
                        <div class="status-card">
                            <div class="status-value" id="batteryLevel">85%</div>
                            <div class="status-label">Battery</div>
                        </div>
                        <div class="status-card">
                            <div class="status-value" id="signalStrength">4/5</div>
                            <div class="status-label">Signal</div>
                        </div>
                        <div class="status-card">
                            <div class="status-value" id="movementStatus">MOVING</div>
                            <div class="status-label">Status</div>
                        </div>
                        <div class="status-card">
                            <div class="status-value" id="trackingTime">0:00</div>
                            <div class="status-label">Tracking</div>
                        </div>
                    </div>
                    
                    <div class="battery-indicator">
                        <div class="battery-fill" id="batteryBar" style="width: 85%;"></div>
                    </div>
                    
                    <div style="font-size: 12px; opacity: 0.7; text-align: center;">
                        Estimated time remaining: <span id="batteryTime">6h 23m</span>
                    </div>
                </div>
            </div>

            <!-- Security Controls -->
            <div class="panel-section">
                <div class="panel-title">
                    üîí Security Controls
                </div>
                <div class="control-buttons">
                    <button class="control-btn" onclick="lockDevice()">
                        üîí Lock Device
                    </button>
                    <button class="control-btn warning" onclick="soundAlarm()">
                        üö® Sound Alarm
                    </button>
                    <button class="control-btn success" onclick="takePhoto()">
                        üì∏ Capture Photo
                    </button>
                    <button class="control-btn danger" onclick="wipeData()">
                        üóëÔ∏è Wipe Data
                    </button>
                </div>
            </div>

            <!-- Camera Section -->
            <div class="panel-section">
                <div class="panel-title">
                    üì∑ Remote Camera
                </div>
                <div class="camera-section">
                    <div class="camera-preview" id="cameraPreview">
                        <div class="camera-placeholder">
                            Click "Start Camera" to begin live feed
                        </div>
                        <div class="recording-indicator" id="recordingIndicator" style="display: none;">
                            ‚óè REC
                        </div>
                    </div>
                    <div class="camera-controls">
                        <button class="control-btn" onclick="startCamera()">
                            üìπ Start Camera
                        </button>
                        <button class="control-btn" onclick="capturePhoto()">
                            üì∏ Capture
                        </button>
                    </div>
                </div>
            </div>

            <!-- Live Activity Feed -->
            <div class="panel-section">
                <div class="panel-title">
                    üìä Live Activity Feed
                </div>
                <div class="location-history" id="activityFeed">
                    <div class="location-item">
                        <div>üéØ Tracking started</div>
                        <div class="location-time">Just now</div>
                    </div>
                </div>
            </div>

            <!-- Movement Analytics -->
            <div class="panel-section">
                <div class="panel-title">
                    üìà Movement Analytics
                </div>
                <div class="device-status">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 15px;">
                        <div style="text-align: center;">
                            <div style="font-size: 1.2rem; font-weight: 700; color: #3b82f6;" id="avgSpeed">0 km/h</div>
                            <div style="font-size: 12px; opacity: 0.7;">Avg Speed</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 1.2rem; font-weight: 700; color: #10b981;" id="maxSpeed">0 km/h</div>
                            <div style="font-size: 12px; opacity: 0.7;">Max Speed</div>
                        </div>
                    </div>
                    <div style="font-size: 12px; opacity: 0.7; text-align: center;">
                        Movement pattern: <span id="movementPattern">Analyzing...</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // Initialize map
        let map = L.map('map').setView([37.9755, 23.7348], 18);
        let deviceMarker = null;
        let trackingPath = [];
        let isTracking = true; // Start tracking immediately
        let cameraActive = false;
        
        // Tracking variables
        let lastPosition = {lat: 37.9755, lng: 23.7348};
        let timeAtCurrentLocation = 0;
        let stepCount = 0;
        let totalDistance = 0;
        let trackingStartTime = Date.now();
        let locationStartTime = Date.now();
        let isMoving = false;

        // Add map tiles
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '¬© OpenStreetMap contributors'
        }).addTo(map);

        // Device marker
        const deviceIcon = L.divIcon({
            html: '<div style="background: #ef4444; width: 20px; height: 20px; border-radius: 50%; border: 3px solid white; box-shadow: 0 0 10px rgba(239,68,68,0.5);"></div>',
            iconSize: [20, 20],
            className: 'device-marker'
        });

        deviceMarker = L.marker([37.9755, 23.7348], {icon: deviceIcon}).addTo(map)
            .bindPopup('<b>Target Device</b><br>Last seen: Just now');

        // Calculate distance between two points
        function calculateDistance(lat1, lng1, lat2, lng2) {
            const R = 6371e3; // Earth's radius in meters
            const œÜ1 = lat1 * Math.PI/180;
            const œÜ2 = lat2 * Math.PI/180;
            const ŒîœÜ = (lat2-lat1) * Math.PI/180;
            const ŒîŒª = (lng2-lng1) * Math.PI/180;

            const a = Math.sin(ŒîœÜ/2) * Math.sin(ŒîœÜ/2) +
                      Math.cos(œÜ1) * Math.cos(œÜ2) *
                      Math.sin(ŒîŒª/2) * Math.sin(ŒîŒª/2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));

            return R * c; // Distance in meters
        }

        // Simulate realistic movement
        function simulateMovement() {
            if (!isTracking) return;
            
            const currentPos = deviceMarker.getLatLng();
            
            // Simulate realistic movement patterns
            const movementChance = Math.random();
            let newLat = currentPos.lat;
            let newLng = currentPos.lng;
            let speed = 0;
            
            if (movementChance > 0.3) { // 70% chance of movement
                // Realistic movement (walking/running speed)
                const moveDistance = Math.random() * 0.0001; // Small realistic steps
                const direction = Math.random() * 2 * Math.PI;
                
                newLat += Math.cos(direction) * moveDistance;
                newLng += Math.sin(direction) * moveDistance;
                
                // Calculate distance moved
                const distanceMoved = calculateDistance(currentPos.lat, currentPos.lng, newLat, newLng);
                totalDistance += distanceMoved;
                
                // Calculate speed (km/h)
                speed = Math.floor((distanceMoved / 1000) * 3600); // Convert to km/h
                if (speed < 1) speed = Math.floor(Math.random() * 5) + 1; // Walking speed 1-5 km/h
                
                stepCount += Math.floor(distanceMoved / 0.7); // Average step length 0.7m
                isMoving = true;
                locationStartTime = Date.now(); // Reset location timer when moving
            } else {
                // Stationary
                speed = 0;
                isMoving = false;
            }
            
            // Update position
            deviceMarker.setLatLng([newLat, newLng]);
            trackingPath.push([newLat, newLng]);
            lastPosition = {lat: newLat, lng: newLng};
            
            // Update displays
            document.getElementById('coordinates').textContent = 
                `${newLat.toFixed(6)}¬∞N, ${newLng.toFixed(6)}¬∞E`;
            
            document.getElementById('currentSpeed').textContent = `${speed} km/h`;
            document.getElementById('stepCount').textContent = stepCount;
            document.getElementById('totalDistance').textContent = `${Math.floor(totalDistance)}m`;
            
            // Update analytics
            updateMovementAnalytics();
            
            // Update movement status
            const statusElement = document.getElementById('movementStatus');
            if (isMoving) {
                statusElement.textContent = 'MOVING';
                statusElement.style.color = '#ef4444';
            } else {
                statusElement.textContent = 'STATIONARY';
                statusElement.style.color = '#f59e0b';
            }
            
            // Update GPS accuracy (more accurate when stationary)
            const accuracy = isMoving ? Math.floor(Math.random() * 5) + 3 : Math.floor(Math.random() * 2) + 1;
            document.getElementById('gpsAccuracy').textContent = `¬±${accuracy}m`;
            
            // Update last update time
            document.getElementById('lastUpdate').textContent = 'Live';
            
            // Continue tracking every 1 second for real-time feel
            setTimeout(simulateMovement, 1000);
        }

        // Update time counters
        function updateTimeCounters() {
            // Time at current location (if stationary)
            if (!isMoving) {
                timeAtCurrentLocation = Math.floor((Date.now() - locationStartTime) / 1000);
                const minutes = Math.floor(timeAtCurrentLocation / 60);
                const seconds = timeAtCurrentLocation % 60;
                document.getElementById('timeAtLocation').textContent = `${minutes}m ${seconds}s`;
            } else {
                timeAtCurrentLocation = 0;
                document.getElementById('timeAtLocation').textContent = '0m 0s';
            }
            
            // Total tracking time
            const totalTrackingTime = Math.floor((Date.now() - trackingStartTime) / 1000);
            const hours = Math.floor(totalTrackingTime / 3600);
            const minutes = Math.floor((totalTrackingTime % 3600) / 60);
            const seconds = totalTrackingTime % 60;
            
            if (hours > 0) {
                document.getElementById('trackingTime').textContent = `${hours}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            } else {
                document.getElementById('trackingTime').textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
            }
        }

        // Simulate realistic battery drain
        function simulateBattery() {
            const batteryElement = document.getElementById('batteryLevel');
            const batteryBar = document.getElementById('batteryBar');
            const batteryStatus = document.getElementById('batteryStatus');
            const batteryTime = document.getElementById('batteryTime');
            
            let currentBattery = 85;
            
            setInterval(() => {
                if (currentBattery > 0) {
                    // Battery drains faster when moving/using GPS/camera
                    let drainRate = 0.1; // Base drain
                    if (isMoving) drainRate += 0.1; // Extra drain when moving
                    if (cameraActive) drainRate += 0.2; // Extra drain for camera
                    
                    currentBattery -= drainRate;
                    if (currentBattery < 0) currentBattery = 0;
                    
                    const batteryPercent = Math.floor(currentBattery);
                    batteryElement.textContent = `${batteryPercent}%`;
                    batteryStatus.textContent = `${batteryPercent}%`;
                    batteryBar.style.width = `${batteryPercent}%`;
                    
                    // Change color based on battery level
                    if (batteryPercent < 20) {
                        batteryBar.classList.add('battery-low');
                        if (batteryPercent < 10) {
                            showAlert('‚ö†Ô∏è CRITICAL: Battery below 10%');
                        }
                    } else {
                        batteryBar.classList.remove('battery-low');
                    }
                    
                    // Update estimated time (more realistic calculation)
                    const hoursRemaining = currentBattery / (drainRate * 60); // Hours
                    const hours = Math.floor(hoursRemaining);
                    const minutes = Math.floor((hoursRemaining % 1) * 60);
                    batteryTime.textContent = `${hours}h ${minutes}m`;
                }
            }, 10000); // Update every 10 seconds for more realistic feel
        }

        // Control functions
        function centerOnDevice() {
            map.setView(deviceMarker.getLatLng(), 18);
        }

        function toggleTracking() {
            isTracking = !isTracking;
            const btn = event.target;
            
            if (isTracking) {
                btn.textContent = '‚èπÔ∏è Stop Tracking';
                btn.style.background = 'linear-gradient(135deg, #ef4444, #dc2626)';
                simulateMovement();
                showAlert('üéØ Live tracking activated');
            } else {
                btn.textContent = 'üéØ Live Tracking';
                btn.style.background = 'rgba(15, 23, 42, 0.9)';
                showAlert('‚èπÔ∏è Live tracking stopped');
            }
        }

        function showRoute() {
            if (trackingPath.length > 1) {
                L.polyline(trackingPath, {color: '#ef4444', weight: 3}).addTo(map);
                showAlert('üõ£Ô∏è Route displayed on map');
            } else {
                showAlert('‚ö†Ô∏è No route data available');
            }
        }

        function satelliteView() {
            // Toggle between satellite and street view
            showAlert('üõ∞Ô∏è Satellite view activated');
        }

        function lockDevice() {
            showAlert('üîí Device locked remotely');
        }

        function soundAlarm() {
            showAlert('üö® Alarm activated - 120dB siren');
        }

        function takePhoto() {
            showAlert('üì∏ Photo captured from front camera');
            addLocationHistory('Photo taken', 'Just now');
        }

        function wipeData() {
            if (confirm('‚ö†Ô∏è This will permanently delete all data. Continue?')) {
                showAlert('üóëÔ∏è Remote data wipe initiated');
            }
        }

        function startCamera() {
            cameraActive = !cameraActive;
            const preview = document.getElementById('cameraPreview');
            const indicator = document.getElementById('recordingIndicator');
            const btn = event.target;
            
            if (cameraActive) {
                preview.innerHTML = `
                    <video class="live-feed" autoplay muted>
                        <source src="data:video/mp4;base64," type="video/mp4">
                    </video>
                    <div class="recording-indicator">‚óè LIVE</div>
                `;
                btn.textContent = '‚èπÔ∏è Stop Camera';
                btn.style.background = 'linear-gradient(135deg, #ef4444, #dc2626)';
                showAlert('üìπ Front camera activated');
            } else {
                preview.innerHTML = `
                    <div class="camera-placeholder">
                        Camera stopped
                    </div>
                `;
                btn.textContent = 'üìπ Start Camera';
                btn.style.background = 'linear-gradient(135deg, #3b82f6, #1d4ed8)';
                showAlert('üìπ Camera deactivated');
            }
        }

        function capturePhoto() {
            if (cameraActive) {
                showAlert('üì∏ Photo captured and saved');
                addLocationHistory('Photo captured', 'Just now');
            } else {
                showAlert('‚ö†Ô∏è Please start camera first');
            }
        }

        function showAlert(message) {
            const banner = document.getElementById('alertBanner');
            banner.textContent = message;
            banner.style.display = 'block';
            
            setTimeout(() => {
                banner.style.display = 'none';
            }, 3000);
        }

        // Activity tracking
        let speedHistory = [];
        let maxSpeedRecorded = 0;

        function addActivityFeed(action, time) {
            const feed = document.getElementById('activityFeed');
            const newItem = document.createElement('div');
            newItem.className = 'location-item';
            newItem.innerHTML = `
                <div>${action}</div>
                <div class="location-time">${time}</div>
            `;
            feed.insertBefore(newItem, feed.firstChild);
            
            // Keep only last 15 items
            while (feed.children.length > 15) {
                feed.removeChild(feed.lastChild);
            }
        }

        function updateMovementAnalytics() {
            const currentSpeed = parseInt(document.getElementById('currentSpeed').textContent);
            
            // Track speed history
            speedHistory.push(currentSpeed);
            if (speedHistory.length > 60) { // Keep last 60 readings (1 minute)
                speedHistory.shift();
            }
            
            // Update max speed
            if (currentSpeed > maxSpeedRecorded) {
                maxSpeedRecorded = currentSpeed;
                document.getElementById('maxSpeed').textContent = `${maxSpeedRecorded} km/h`;
                
                if (maxSpeedRecorded > 20) {
                    addActivityFeed(`üöó New max speed: ${maxSpeedRecorded} km/h`, 'Just now');
                }
            }
            
            // Calculate average speed
            const avgSpeed = speedHistory.length > 0 ? 
                Math.floor(speedHistory.reduce((a, b) => a + b, 0) / speedHistory.length) : 0;
            document.getElementById('avgSpeed').textContent = `${avgSpeed} km/h`;
            
            // Determine movement pattern
            let pattern = 'Stationary';
            if (avgSpeed > 0 && avgSpeed <= 5) pattern = 'Walking';
            else if (avgSpeed > 5 && avgSpeed <= 15) pattern = 'Running/Cycling';
            else if (avgSpeed > 15 && avgSpeed <= 50) pattern = 'Vehicle (City)';
            else if (avgSpeed > 50) pattern = 'Vehicle (Highway)';
            
            document.getElementById('movementPattern').textContent = pattern;
            
            // Add activity based on movement changes
            if (isMoving && speedHistory.length > 5) {
                const recentSpeeds = speedHistory.slice(-5);
                const speedChange = Math.max(...recentSpeeds) - Math.min(...recentSpeeds);
                
                if (speedChange > 10) {
                    addActivityFeed('‚ö° Rapid speed change detected', 'Just now');
                }
            }
        }

        // Add real-time alerts based on behavior
        function checkSuspiciousActivity() {
            // Alert if device stays in same location too long
            if (!isMoving && timeAtCurrentLocation > 300) { // 5 minutes
                showAlert('‚ö†Ô∏è Device stationary for 5+ minutes');
            }
            
            // Alert if moving at high speed (possible vehicle)
            const currentSpeed = parseInt(document.getElementById('currentSpeed').textContent);
            if (currentSpeed > 30) {
                showAlert('üöó High speed detected - possible vehicle movement');
            }
            
            // Alert if battery getting low
            const battery = parseInt(document.getElementById('batteryLevel').textContent);
            if (battery === 25) {
                showAlert('üîã Battery at 25% - consider remote actions');
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            simulateBattery();
            simulateMovement(); // Start tracking immediately
            
            // Update time counters every second
            setInterval(updateTimeCounters, 1000);
            
            // Check for suspicious activity every 30 seconds
            setInterval(checkSuspiciousActivity, 30000);
            
            // Show initial alert
            setTimeout(() => {
                showAlert('üõ°Ô∏è Live tracking system activated');
            }, 1000);
            
            // Simulate theft detection after 5 seconds
            setTimeout(() => {
                showAlert('üö® THEFT DETECTED - Device moved without authorization');
            }, 5000);
        });
    </script>
</body>
</html>