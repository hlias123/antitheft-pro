<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secure Guardian - App PIN Login</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="25" cy="25" r="1" fill="rgba(255,255,255,0.1)"/><circle cx="75" cy="75" r="1" fill="rgba(255,255,255,0.05)"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
            pointer-events: none;
        }

        .container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(30px);
            padding: 50px;
            border-radius: 30px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            width: 100%;
            max-width: 500px;
            text-align: center;
            box-shadow: 
                0 25px 50px rgba(0, 0, 0, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            position: relative;
            z-index: 1;
        }

        .logo {
            font-size: 5rem;
            margin-bottom: 20px;
            background: linear-gradient(135deg, #fff, #f0f9ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            filter: drop-shadow(0 4px 8px rgba(0,0,0,0.3));
            animation: float 3s ease-in-out infinite;
        }

        .title {
            font-size: 2.5rem;
            margin-bottom: 15px;
            font-weight: 800;
            color: white;
            text-shadow: 0 2px 10px rgba(0,0,0,0.3);
            letter-spacing: -1px;
        }

        .subtitle {
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 40px;
            font-size: 18px;
            font-weight: 300;
            line-height: 1.6;
        }

        /* Language Selector */
        .language-selector {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 40px;
        }

        .lang-btn {
            padding: 12px 20px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            backdrop-filter: blur(10px);
        }

        .lang-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.2);
        }

        .lang-btn.active {
            background: linear-gradient(135deg, rgba(255,255,255,0.3), rgba(255,255,255,0.1));
            border-color: rgba(255, 255, 255, 0.6);
            box-shadow: 0 8px 20px rgba(255, 255, 255, 0.3);
        }

        /* Login Form */
        .login-form {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 30px;
            border-radius: 20px;
            backdrop-filter: blur(20px);
            margin-bottom: 30px;
        }

        .form-title {
            color: white;
            font-size: 1.4rem;
            font-weight: 700;
            margin-bottom: 25px;
            text-align: center;
        }

        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }

        .form-group label {
            display: block;
            color: rgba(255, 255, 255, 0.9);
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .form-input {
            width: 100%;
            padding: 15px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            color: white;
            font-size: 16px;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .form-input::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }

        .form-input:focus {
            outline: none;
            border-color: #10b981;
            box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.2);
            background: rgba(255, 255, 255, 0.15);
        }

        /* PIN Input */
        .pin-container {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
        }

        .pin-input {
            width: 50px;
            height: 50px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            color: white;
            font-size: 20px;
            font-weight: bold;
            text-align: center;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .pin-input:focus {
            outline: none;
            border-color: #10b981;
            box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.2);
            background: rgba(255, 255, 255, 0.2);
        }

        .btn {
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 15px;
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.3);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 30px rgba(16, 185, 129, 0.4);
        }

        /* Info Panel */
        .info-panel {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.15), rgba(37, 99, 235, 0.1));
            border: 1px solid rgba(59, 130, 246, 0.3);
            padding: 20px;
            border-radius: 15px;
            margin-top: 20px;
            color: rgba(255, 255, 255, 0.9);
            font-size: 14px;
            line-height: 1.6;
        }

        .app-download {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.15), rgba(5, 150, 105, 0.1));
            border: 1px solid rgba(16, 185, 129, 0.3);
            padding: 20px;
            border-radius: 15px;
            margin-top: 20px;
            text-align: center;
        }

        .download-btn {
            display: inline-block;
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            padding: 12px 25px;
            border-radius: 25px;
            text-decoration: none;
            font-weight: 600;
            margin: 10px;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(16, 185, 129, 0.3);
        }

        .download-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(16, 185, 129, 0.4);
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        @keyframes pulse {
            0%, 100% { 
                box-shadow: 0 0 10px rgba(239,68,68,0.5);
                transform: scale(1);
            }
            50% { 
                box-shadow: 0 0 20px rgba(239,68,68,0.8);
                transform: scale(1.1);
            }
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Dashboard Styles */
        .feature-card {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
        }

        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.15);
        }

        /* Fullscreen Map */
        .map-fullscreen {
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            width: 100vw !important;
            height: 100vh !important;
            z-index: 9999 !important;
            background: rgba(15, 23, 42, 0.95) !important;
            backdrop-filter: blur(10px) !important;
            border-radius: 0 !important;
            margin: 0 !important;
        }

        .map-fullscreen #map {
            height: calc(100vh - 100px) !important;
            margin-top: 50px !important;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="logo">üõ°Ô∏è</div>
        <h1 class="title" id="mainTitle">Secure Guardian</h1>
        <p class="subtitle" id="mainSubtitle">App-Controlled Web Access</p>
        
        <!-- Language Selector -->
        <div class="language-selector">
            <button class="lang-btn active" onclick="setLanguage('en')">üá¨üáß English</button>
            <button class="lang-btn" onclick="setLanguage('el')">üá¨üá∑ ŒïŒªŒªŒ∑ŒΩŒπŒ∫Œ¨</button>
            <button class="lang-btn" onclick="setLanguage('ar')">üá∏üá¶ ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</button>
        </div>

        <div id="messageDiv"></div>
        
        <!-- Login Form -->
        <div class="login-form">
            <h3 class="form-title" id="loginTitle">üì± App PIN Login</h3>
            
            <div class="form-group">
                <label for="email" id="emailLabel">Email Address</label>
                <input type="email" id="email" class="form-input" placeholder="Enter your registered email">
            </div>
            
            <div class="form-group">
                <label id="pinLabel">6-Digit PIN from Mobile App</label>
                <div class="pin-container">
                    <input type="text" class="pin-input" maxlength="1" oninput="moveToNext(this, 0)">
                    <input type="text" class="pin-input" maxlength="1" oninput="moveToNext(this, 1)">
                    <input type="text" class="pin-input" maxlength="1" oninput="moveToNext(this, 2)">
                    <input type="text" class="pin-input" maxlength="1" oninput="moveToNext(this, 3)">
                    <input type="text" class="pin-input" maxlength="1" oninput="moveToNext(this, 4)">
                    <input type="text" class="pin-input" maxlength="1" oninput="moveToNext(this, 5)">
                </div>
            </div>
            
            <button class="btn" onclick="loginWithPin()">
                <span id="loginBtn">üöÄ Access Website</span>
            </button>
        </div>

        <!-- Info Panel -->
        <div class="info-panel">
            <h4 id="howItWorksTitle">üìã How it works:</h4>
            <ol id="stepsList" style="text-align: left; margin: 15px 0; padding-left: 20px;">
                <li id="step1">Open the Secure Guardian mobile app</li>
                <li id="step2">Generate a 6-digit PIN for web access</li>
                <li id="step3">Enter your email and PIN above</li>
                <li id="step4">Access granted for this session only</li>
            </ol>
        </div>

        <!-- Demo Notice -->
        <div style="background: linear-gradient(135deg, rgba(251, 191, 36, 0.15), rgba(245, 158, 11, 0.1)); border: 1px solid rgba(251, 191, 36, 0.3); padding: 15px; border-radius: 12px; margin: 15px 0; color: rgba(255,255,255,0.9); font-size: 14px; text-align: center;">
            <strong id="demoNotice">üß™ Demo Mode: Enter any 6-digit PIN to test the dashboard</strong>
        </div>

        <!-- App Download -->
        <div class="app-download">
            <h4 id="downloadTitle">üì± Don't have the app?</h4>
            <p id="downloadDesc" style="margin: 10px 0; color: rgba(255,255,255,0.9);">Download Secure Guardian mobile app to generate access PINs</p>
            <a href="#" class="download-btn" id="downloadAndroid">üì± Android App</a>
        </div>

        <!-- Dashboard (Hidden initially) -->
        <div id="dashboardSection" style="display: none;">
            <h2 id="dashboardTitle" style="color: white; margin-bottom: 30px;">üõ°Ô∏è Security Dashboard</h2>
            
            <!-- User Info -->
            <div class="info-panel" style="margin-bottom: 20px;">
                <h4 id="welcomeTitle">üëã Welcome!</h4>
                <p id="userEmail" style="margin: 10px 0; font-weight: bold;"></p>
                <p id="sessionInfo" style="font-size: 12px; opacity: 0.8;">Session active - PIN verified via mobile app</p>
            </div>

            <!-- Advanced Map Section (Full Size) -->
            <div style="background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.2); border-radius: 20px; padding: 0; margin-bottom: 20px; overflow: hidden;">
                <!-- Map Header -->
                <div style="background: linear-gradient(135deg, #1e293b, #334155); padding: 15px 20px; display: flex; justify-content: space-between; align-items: center;">
                    <h4 id="mapTitle" style="color: white; margin: 0; display: flex; align-items: center; gap: 10px;">üó∫Ô∏è Advanced Live Tracking</h4>
                    <div style="display: flex; gap: 10px;">
                        <button onclick="centerOnDevice()" style="background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.3); color: white; padding: 8px 12px; border-radius: 15px; cursor: pointer; font-size: 12px;">üìç Center</button>
                        <button onclick="toggleTracking()" style="background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.3); color: white; padding: 8px 12px; border-radius: 15px; cursor: pointer; font-size: 12px;">üéØ Track</button>
                    </div>
                </div>
                
                <!-- Large Map Container -->
                <div style="position: relative;">
                    <div id="map" style="width: 100%; height: 600px;"></div>
                    
                    <!-- Map Info Overlay -->
                    <div style="position: absolute; bottom: 20px; left: 20px; background: rgba(15, 23, 42, 0.95); padding: 15px; border-radius: 12px; backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.1); min-width: 280px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                            <strong style="color: white;">üéØ Live Tracking</strong>
                            <span style="font-size: 12px; opacity: 0.7; color: white;">Live</span>
                        </div>
                        <div id="coordinates" style="color: white; font-family: monospace;">37.9755¬∞N, 23.7348¬∞E</div>
                        <div style="font-size: 12px; opacity: 0.7; margin-top: 8px; color: white;">
                            Speed: <span id="currentSpeed">0 km/h</span> | 
                            Accuracy: <span id="gpsAccuracy">¬±3m</span>
                        </div>
                        <div style="font-size: 12px; margin-top: 8px; padding: 8px; background: rgba(16,185,129,0.2); border-radius: 6px; color: white;">
                            ‚è±Ô∏è Tracking: <span id="trackingTime">0:00</span> | 
                            Distance: <span id="totalDistance">0m</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Security Features Grid -->
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin: 20px 0;">
                <div class="feature-card" onclick="lockDevice()">
                    <div style="font-size: 2rem; margin-bottom: 10px;">üîí</div>
                    <div style="font-weight: 600; color: white; margin-bottom: 5px;" id="lockTitle">Remote Lock</div>
                    <div style="font-size: 12px; color: rgba(255,255,255,0.7);" id="lockDesc">Lock your device</div>
                </div>
                
                <div class="feature-card" onclick="soundAlarm()">
                    <div style="font-size: 2rem; margin-bottom: 10px;">üö®</div>
                    <div style="font-weight: 600; color: white; margin-bottom: 5px;" id="alarmTitle">Sound Alarm</div>
                    <div style="font-size: 12px; color: rgba(255,255,255,0.7);" id="alarmDesc">Activate alarm</div>
                </div>
                
                <div class="feature-card" onclick="refreshLocation()">
                    <div style="font-size: 2rem; margin-bottom: 10px;">üìç</div>
                    <div style="font-weight: 600; color: white; margin-bottom: 5px;" id="trackTitle">Refresh Location</div>
                    <div style="font-size: 12px; color: rgba(255,255,255,0.7);" id="trackDesc">Update device position</div>
                </div>
                
                <div class="feature-card" onclick="wipeData()">
                    <div style="font-size: 2rem; margin-bottom: 10px;">üóëÔ∏è</div>
                    <div style="font-weight: 600; color: white; margin-bottom: 5px;" id="wipeTitle">Wipe Data</div>
                    <div style="font-size: 12px; color: rgba(255,255,255,0.7);" id="wipeDesc">Erase all data</div>
                </div>
            </div>

            <!-- Logout Button -->
            <button class="btn" onclick="logout()" style="background: linear-gradient(135deg, #ef4444, #dc2626); margin-top: 20px;">
                <span id="logoutBtn">üö™ Sign Out</span>
            </button>
        </div>
    </div>

    <!-- Leaflet Map CSS and JS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <script>
        let currentLanguage = 'en';

        // Complete translations
        const translations = {
            en: {
                mainTitle: "Secure Guardian",
                mainSubtitle: "App-Controlled Web Access",
                loginTitle: "üì± App PIN Login",
                emailLabel: "Email Address",
                pinLabel: "6-Digit PIN from Mobile App",
                loginBtn: "üöÄ Access Website",
                howItWorksTitle: "üìã How it works:",
                step1: "Open the Secure Guardian mobile app",
                step2: "Generate a 6-digit PIN for web access",
                step3: "Enter your email and PIN above",
                step4: "Access granted for this session only",
                downloadTitle: "üì± Don't have the app?",
                downloadDesc: "Download Secure Guardian mobile app to generate access PINs",
                downloadAndroid: "üì± Android App",
                emailRequired: '‚ö†Ô∏è Please enter your email address',
                pinRequired: '‚ö†Ô∏è Please enter the complete 6-digit PIN',
                verifying: 'üîÑ Verifying PIN with mobile app...',
                success: '‚úÖ PIN verified! Welcome to Secure Guardian Dashboard',
                emailPlaceholder: "Enter your registered email",
                dashboardTitle: "üõ°Ô∏è Security Dashboard",
                welcomeTitle: "üëã Welcome!",
                sessionInfo: "Session active - PIN verified via mobile app",
                lockTitle: "Remote Lock",
                lockDesc: "Lock your device",
                alarmTitle: "Sound Alarm",
                alarmDesc: "Activate alarm",
                mapTitle: "üó∫Ô∏è Advanced Live Tracking",
                mapInfo: "üìç Last updated: Just now ‚Ä¢ Accuracy: ¬±5 meters",
                fullscreenBtn: "üîç Fullscreen",
                exitFullscreenBtn: "‚ùå Exit Fullscreen",
                trackTitle: "Refresh Location",
                trackDesc: "Update device position",
                wipeTitle: "Wipe Data",
                wipeDesc: "Erase all data",
                logoutBtn: "üö™ Sign Out",
                demoNotice: "üß™ Demo Mode: Enter any 6-digit PIN to test the dashboard"
            },
            el: {
                mainTitle: "ŒëœÉœÜŒ±ŒªŒÆœÇ Œ¶œçŒªŒ±Œ∫Œ±œÇ",
                mainSubtitle: "Œ†œÅœåœÉŒ≤Œ±œÉŒ∑ ŒôœÉœÑŒøœç ŒºŒ≠œÉœâ ŒïœÜŒ±œÅŒºŒøŒ≥ŒÆœÇ",
                loginTitle: "üì± Œ£œçŒΩŒ¥ŒµœÉŒ∑ ŒºŒµ PIN ŒïœÜŒ±œÅŒºŒøŒ≥ŒÆœÇ",
                emailLabel: "ŒîŒπŒµœçŒ∏œÖŒΩœÉŒ∑ Email",
                pinLabel: "6œàŒÆœÜŒπŒøœÇ PIN Œ±œÄœå œÑŒ∑ŒΩ ŒïœÜŒ±œÅŒºŒøŒ≥ŒÆ ŒöŒπŒΩŒ∑œÑŒøœç",
                loginBtn: "üöÄ Œ†œÅœåœÉŒ≤Œ±œÉŒ∑ œÉœÑŒøŒΩ ŒôœÉœÑœåœÑŒøœÄŒø",
                howItWorksTitle: "üìã Œ†œéœÇ ŒªŒµŒπœÑŒøœÖœÅŒ≥ŒµŒØ:",
                step1: "ŒëŒΩŒøŒØŒæœÑŒµ œÑŒ∑ŒΩ ŒµœÜŒ±œÅŒºŒøŒ≥ŒÆ ŒëœÉœÜŒ±ŒªŒÆœÇ Œ¶œçŒªŒ±Œ∫Œ±œÇ œÉœÑŒø Œ∫ŒπŒΩŒ∑œÑœå",
                step2: "ŒîŒ∑ŒºŒπŒøœÖœÅŒ≥ŒÆœÉœÑŒµ Œ≠ŒΩŒ±ŒΩ 6œàŒÆœÜŒπŒø PIN Œ≥ŒπŒ± œÄœÅœåœÉŒ≤Œ±œÉŒ∑ œÉœÑŒøŒΩ ŒπœÉœÑœå",
                step3: "ŒïŒπœÉŒ¨Œ≥ŒµœÑŒµ œÑŒø email Œ∫Œ±Œπ œÑŒøŒΩ PIN œÄŒ±œÅŒ±œÄŒ¨ŒΩœâ",
                step4: "Œó œÄœÅœåœÉŒ≤Œ±œÉŒ∑ œÄŒ±œÅŒ≠œáŒµœÑŒ±Œπ ŒºœåŒΩŒø Œ≥ŒπŒ± Œ±œÖœÑŒÆ œÑŒ∑ œÉœÖŒΩŒµŒ¥œÅŒØŒ±",
                downloadTitle: "üì± ŒîŒµŒΩ Œ≠œáŒµœÑŒµ œÑŒ∑ŒΩ ŒµœÜŒ±œÅŒºŒøŒ≥ŒÆ;",
                downloadDesc: "ŒöŒ±œÑŒµŒ≤Œ¨œÉœÑŒµ œÑŒ∑ŒΩ ŒµœÜŒ±œÅŒºŒøŒ≥ŒÆ ŒëœÉœÜŒ±ŒªŒÆœÇ Œ¶œçŒªŒ±Œ∫Œ±œÇ Œ≥ŒπŒ± ŒΩŒ± Œ¥Œ∑ŒºŒπŒøœÖœÅŒ≥ŒÆœÉŒµœÑŒµ PIN œÄœÅœåœÉŒ≤Œ±œÉŒ∑œÇ",
                downloadAndroid: "üì± ŒïœÜŒ±œÅŒºŒøŒ≥ŒÆ Android",
                emailRequired: '‚ö†Ô∏è Œ†Œ±œÅŒ±Œ∫Œ±Œªœé ŒµŒπœÉŒ¨Œ≥ŒµœÑŒµ œÑŒ∑ Œ¥ŒπŒµœçŒ∏œÖŒΩœÉŒ∑ email œÉŒ±œÇ',
                pinRequired: '‚ö†Ô∏è Œ†Œ±œÅŒ±Œ∫Œ±Œªœé ŒµŒπœÉŒ¨Œ≥ŒµœÑŒµ œÑŒøŒΩ œÄŒªŒÆœÅŒ∑ 6œàŒÆœÜŒπŒø PIN',
                verifying: 'üîÑ ŒïœÄŒ±ŒªŒÆŒ∏ŒµœÖœÉŒ∑ PIN ŒºŒµ œÑŒ∑ŒΩ ŒµœÜŒ±œÅŒºŒøŒ≥ŒÆ Œ∫ŒπŒΩŒ∑œÑŒøœç...',
                success: '‚úÖ Œü PIN ŒµœÄŒ±ŒªŒ∑Œ∏ŒµœçœÑŒ∑Œ∫Œµ! ŒöŒ±ŒªœéœÇ ŒÆœÅŒ∏Œ±œÑŒµ œÉœÑŒøŒΩ Œ†ŒØŒΩŒ±Œ∫Œ± ŒïŒªŒ≠Œ≥œáŒøœÖ œÑŒøœÖ ŒëœÉœÜŒ±ŒªŒøœçœÇ Œ¶œçŒªŒ±Œ∫Œ±',
                emailPlaceholder: "ŒïŒπœÉŒ¨Œ≥ŒµœÑŒµ œÑŒø ŒµŒ≥Œ≥ŒµŒ≥œÅŒ±ŒºŒºŒ≠ŒΩŒø email œÉŒ±œÇ",
                dashboardTitle: "üõ°Ô∏è Œ†ŒØŒΩŒ±Œ∫Œ±œÇ ŒëœÉœÜŒ±ŒªŒµŒØŒ±œÇ",
                welcomeTitle: "üëã ŒöŒ±ŒªœéœÇ ŒÆœÅŒ∏Œ±œÑŒµ!",
                sessionInfo: "ŒïŒΩŒµœÅŒ≥ŒÆ œÉœÖŒΩŒµŒ¥œÅŒØŒ± - PIN ŒµœÄŒ±ŒªŒ∑Œ∏ŒµœçœÑŒ∑Œ∫Œµ ŒºŒ≠œÉœâ ŒµœÜŒ±œÅŒºŒøŒ≥ŒÆœÇ Œ∫ŒπŒΩŒ∑œÑŒøœç",
                lockTitle: "ŒëœÄŒøŒºŒ±Œ∫œÅœÖœÉŒºŒ≠ŒΩŒø ŒöŒªŒµŒØŒ¥œâŒºŒ±",
                lockDesc: "ŒöŒªŒµŒπŒ¥œéœÉœÑŒµ œÑŒ∑ œÉœÖœÉŒ∫ŒµœÖŒÆ œÉŒ±œÇ",
                alarmTitle: "ŒâœáŒøœÇ Œ£œÖŒΩŒ±Œ≥ŒµœÅŒºŒøœç",
                alarmDesc: "ŒïŒΩŒµœÅŒ≥ŒøœÄŒøŒØŒ∑œÉŒ∑ œÉœÖŒΩŒ±Œ≥ŒµœÅŒºŒøœç",
                mapTitle: "üó∫Ô∏è Œ†œÅŒøŒ∑Œ≥ŒºŒ≠ŒΩŒ∑ ŒñœâŒΩœÑŒ±ŒΩŒÆ Œ†Œ±œÅŒ±Œ∫ŒøŒªŒøœçŒ∏Œ∑œÉŒ∑",
                mapInfo: "üìç Œ§ŒµŒªŒµœÖœÑŒ±ŒØŒ± ŒµŒΩŒ∑ŒºŒ≠œÅœâœÉŒ∑: ŒúœåŒªŒπœÇ œÑœéœÅŒ± ‚Ä¢ ŒëŒ∫œÅŒØŒ≤ŒµŒπŒ±: ¬±5 ŒºŒ≠œÑœÅŒ±",
                fullscreenBtn: "üîç Œ†ŒªŒÆœÅŒ∑œÇ ŒüŒ∏œåŒΩŒ∑",
                exitFullscreenBtn: "‚ùå ŒàŒæŒøŒ¥ŒøœÇ Œ±œÄœå Œ†ŒªŒÆœÅŒ∑ ŒüŒ∏œåŒΩŒ∑",
                trackTitle: "ŒëŒΩŒ±ŒΩŒ≠œâœÉŒ∑ Œ§ŒøœÄŒøŒ∏ŒµœÉŒØŒ±œÇ",
                trackDesc: "ŒïŒΩŒ∑ŒºŒ≠œÅœâœÉŒ∑ Œ∏Œ≠œÉŒ∑œÇ œÉœÖœÉŒ∫ŒµœÖŒÆœÇ",
                wipeTitle: "ŒîŒπŒ±Œ≥œÅŒ±œÜŒÆ ŒîŒµŒ¥ŒøŒºŒ≠ŒΩœâŒΩ",
                wipeDesc: "ŒîŒπŒ±Œ≥œÅŒ±œÜŒÆ œåŒªœâŒΩ œÑœâŒΩ Œ¥ŒµŒ¥ŒøŒºŒ≠ŒΩœâŒΩ",
                logoutBtn: "üö™ ŒëœÄŒøœÉœçŒΩŒ¥ŒµœÉŒ∑",
                demoNotice: "üß™ ŒõŒµŒπœÑŒøœÖœÅŒ≥ŒØŒ± Demo: ŒïŒπœÉŒ¨Œ≥ŒµœÑŒµ ŒøœÄŒøŒπŒøŒΩŒ¥ŒÆœÄŒøœÑŒµ 6œàŒÆœÜŒπŒø PIN Œ≥ŒπŒ± ŒΩŒ± Œ¥ŒøŒ∫ŒπŒºŒ¨œÉŒµœÑŒµ œÑŒøŒΩ œÄŒØŒΩŒ±Œ∫Œ± ŒµŒªŒ≠Œ≥œáŒøœÖ"
            },
            ar: {
                mainTitle: "ÿßŸÑÿ≠ÿßÿ±ÿ≥ ÿßŸÑÿ¢ŸÖŸÜ",
                mainSubtitle: "ÿßŸÑŸàÿµŸàŸÑ ŸÑŸÑŸàŸäÿ® ÿπÿ®ÿ± ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ",
                loginTitle: "üì± ÿ™ÿ≥ÿ¨ŸäŸÑ ÿØÿÆŸàŸÑ ÿ®PIN ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ",
                emailLabel: "ÿßŸÑÿ®ÿ±ŸäÿØ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä",
                pinLabel: "ÿ±ŸÖÿ≤ PIN ŸÖŸÉŸàŸÜ ŸÖŸÜ 6 ÿ£ÿ±ŸÇÿßŸÖ ŸÖŸÜ ÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑŸáÿßÿ™ŸÅ",
                loginBtn: "üöÄ ÿßŸÑŸàÿµŸàŸÑ ŸÑŸÑŸÖŸàŸÇÿπ",
                howItWorksTitle: "üìã ŸÉŸäŸÅ ŸäÿπŸÖŸÑ:",
                step1: "ÿßŸÅÿ™ÿ≠ ÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑÿ≠ÿßÿ±ÿ≥ ÿßŸÑÿ¢ŸÖŸÜ ÿπŸÑŸâ ÿßŸÑŸáÿßÿ™ŸÅ",
                step2: "ÿ£ŸÜÿ¥ÿ¶ ÿ±ŸÖÿ≤ PIN ŸÖŸÉŸàŸÜ ŸÖŸÜ 6 ÿ£ÿ±ŸÇÿßŸÖ ŸÑŸÑŸàÿµŸàŸÑ ŸÑŸÑŸàŸäÿ®",
                step3: "ÿ£ÿØÿÆŸÑ ÿ®ÿ±ŸäÿØŸÉ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä ŸàÿßŸÑPIN ÿ£ÿπŸÑÿßŸá",
                step4: "Ÿäÿ™ŸÖ ŸÖŸÜÿ≠ ÿßŸÑŸàÿµŸàŸÑ ŸÑŸáÿ∞Ÿá ÿßŸÑÿ¨ŸÑÿ≥ÿ© ŸÅŸÇÿ∑",
                downloadTitle: "üì± ŸÑŸäÿ≥ ŸÑÿØŸäŸÉ ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇÿü",
                downloadDesc: "ÿ≠ŸÖŸÑ ÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑÿ≠ÿßÿ±ÿ≥ ÿßŸÑÿ¢ŸÖŸÜ ŸÑÿ•ŸÜÿ¥ÿßÿ° ÿ±ŸÖŸàÿ≤ PIN ŸÑŸÑŸàÿµŸàŸÑ",
                downloadAndroid: "üì± ÿ™ÿ∑ÿ®ŸäŸÇ ÿ£ŸÜÿØÿ±ŸàŸäÿØ",
                emailRequired: '‚ö†Ô∏è Ÿäÿ±ÿ¨Ÿâ ÿ•ÿØÿÆÿßŸÑ ÿπŸÜŸàÿßŸÜ ÿ®ÿ±ŸäÿØŸÉ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä',
                pinRequired: '‚ö†Ô∏è Ÿäÿ±ÿ¨Ÿâ ÿ•ÿØÿÆÿßŸÑ ÿ±ŸÖÿ≤ PIN ÿßŸÑŸÖŸÉŸàŸÜ ŸÖŸÜ 6 ÿ£ÿ±ŸÇÿßŸÖ ŸÉÿßŸÖŸÑÿßŸã',
                verifying: 'üîÑ ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ PIN ŸÖÿπ ÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑŸáÿßÿ™ŸÅ...',
                success: '‚úÖ ÿ™ŸÖ ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ PIN! ŸÖÿ±ÿ≠ÿ®ÿßŸã ÿ®ŸÉ ŸÅŸä ŸÑŸàÿ≠ÿ© ÿ™ÿ≠ŸÉŸÖ ÿßŸÑÿ≠ÿßÿ±ÿ≥ ÿßŸÑÿ¢ŸÖŸÜ',
                emailPlaceholder: "ÿ£ÿØÿÆŸÑ ÿ®ÿ±ŸäÿØŸÉ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä ÿßŸÑŸÖÿ≥ÿ¨ŸÑ",
                dashboardTitle: "üõ°Ô∏è ŸÑŸàÿ≠ÿ© ÿßŸÑÿ£ŸÖÿßŸÜ",
                welcomeTitle: "üëã ŸÖÿ±ÿ≠ÿ®ÿßŸã!",
                sessionInfo: "ÿßŸÑÿ¨ŸÑÿ≥ÿ© ŸÜÿ¥ÿ∑ÿ© - ÿ™ŸÖ ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ PIN ÿπÿ®ÿ± ÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑŸáÿßÿ™ŸÅ",
                lockTitle: "ÿßŸÑŸÇŸÅŸÑ ÿπŸÜ ÿ®ŸèÿπÿØ",
                lockDesc: "ÿßŸÇŸÅŸÑ ÿ¨Ÿáÿßÿ≤ŸÉ",
                alarmTitle: "ÿ™ÿ¥ÿ∫ŸäŸÑ ÿßŸÑÿ•ŸÜÿ∞ÿßÿ±",
                alarmDesc: "ÿ™ŸÅÿπŸäŸÑ ÿßŸÑÿ•ŸÜÿ∞ÿßÿ±",
                mapTitle: "üó∫Ô∏è ÿßŸÑÿ™ÿ™ÿ®ÿπ ÿßŸÑŸÖÿ®ÿßÿ¥ÿ± ÿßŸÑŸÖÿ™ŸÇÿØŸÖ",
                mapInfo: "üìç ÿ¢ÿÆÿ± ÿ™ÿ≠ÿØŸäÿ´: ÿßŸÑÿ¢ŸÜ ‚Ä¢ ÿßŸÑÿØŸÇÿ©: ¬±5 ÿ£ŸÖÿ™ÿßÿ±",
                fullscreenBtn: "üîç ŸÖŸÑÿ° ÿßŸÑÿ¥ÿßÿ¥ÿ©",
                exitFullscreenBtn: "‚ùå ÿ•ÿ∫ŸÑÿßŸÇ ŸÖŸÑÿ° ÿßŸÑÿ¥ÿßÿ¥ÿ©",
                trackTitle: "ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸÖŸàŸÇÿπ",
                trackDesc: "ÿ™ÿ≠ÿØŸäÿ´ ŸÖŸàÿ∂ÿπ ÿßŸÑÿ¨Ÿáÿßÿ≤",
                wipeTitle: "ŸÖÿ≥ÿ≠ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™",
                wipeDesc: "ÿ≠ÿ∞ŸÅ ÿ¨ŸÖŸäÿπ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™",
                logoutBtn: "üö™ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿÆÿ±Ÿàÿ¨",
                demoNotice: "üß™ Ÿàÿ∂ÿπ ÿßŸÑÿ™ÿ¨ÿ±Ÿäÿ®: ÿ£ÿØÿÆŸÑ ÿ£Ÿä ÿ±ŸÖÿ≤ PIN ŸÖŸÉŸàŸÜ ŸÖŸÜ 6 ÿ£ÿ±ŸÇÿßŸÖ ŸÑÿ™ÿ¨ÿ±ÿ®ÿ© ŸÑŸàÿ≠ÿ© ÿßŸÑÿ™ÿ≠ŸÉŸÖ"
            }
        };

        // Set language
        function setLanguage(lang) {
            currentLanguage = lang;
            
            // Update active button
            document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // Update text direction
            if (lang === 'ar') {
                document.documentElement.dir = 'rtl';
            } else {
                document.documentElement.dir = 'ltr';
            }
            
            // Update all text
            const t = translations[lang];
            Object.keys(t).forEach(key => {
                const element = document.getElementById(key);
                if (element) {
                    element.textContent = t[key];
                }
            });
            
            // Update placeholder
            document.getElementById('email').placeholder = t.emailPlaceholder;
        }

        // Move to next PIN input
        function moveToNext(current, index) {
            if (current.value.length === 1 && index < 5) {
                document.querySelectorAll('.pin-input')[index + 1].focus();
            }
        }

        // Show message
        function showMessage(message, type = 'info') {
            const messageDiv = document.getElementById('messageDiv');
            const colors = {
                success: 'rgba(16, 185, 129, 0.2)',
                error: 'rgba(239, 68, 68, 0.2)',
                info: 'rgba(59, 130, 246, 0.2)'
            };
            
            messageDiv.innerHTML = `
                <div style="background: ${colors[type]}; border: 1px solid rgba(255,255,255,0.3); padding: 15px; border-radius: 12px; margin: 15px 0; color: white; text-align: center;">
                    ${message}
                </div>
            `;
            
            setTimeout(() => {
                messageDiv.innerHTML = '';
            }, 5000);
        }

        // Login with PIN
        async function loginWithPin() {
            const email = document.getElementById('email').value;
            const pinInputs = document.querySelectorAll('.pin-input');
            const pin = Array.from(pinInputs).map(input => input.value).join('');

            if (!email) {
                showMessage(translations[currentLanguage].emailRequired, 'error');
                return;
            }

            if (pin.length !== 6) {
                showMessage(translations[currentLanguage].pinRequired, 'error');
                return;
            }

            // For demo purposes - accept any 6-digit PIN
            showMessage(translations[currentLanguage].verifying, 'info');
            
            setTimeout(() => {
                // Always successful for demo (since app is not ready)
                showMessage(translations[currentLanguage].success, 'success');
                
                // Show dashboard after 1 second
                setTimeout(() => {
                    showDashboard();
                }, 1000);
            }, 1500);
        }

        // Advanced Map variables
        let map = null;
        let deviceMarker = null;
        let currentLat = 37.9755; // Athens coordinates as default
        let currentLng = 23.7348;
        let trackingPath = [];
        let isTracking = true;
        let trackingStartTime = Date.now();
        let totalDistance = 0;
        let isMoving = false;

        // Show full-screen map dashboard
        function showDashboard() {
            const email = document.getElementById('email').value;
            
            // Hide login interface completely
            document.querySelector('.container').style.display = 'none';
            
            // Show full-screen advanced tracking interface
            document.body.innerHTML = `
                <!-- Advanced Tracking Header -->
                <div style="background: linear-gradient(135deg, #1e293b, #334155); padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 4px 20px rgba(0,0,0,0.3); position: relative; z-index: 1000;">
                    <div style="display: flex; align-items: center; gap: 10px; font-size: 1.5rem; font-weight: 700; color: white;">
                        üõ°Ô∏è <span>Advanced Anti-Theft System</span>
                    </div>
                    <div style="display: flex; gap: 20px; align-items: center;">
                        <div style="display: flex; align-items: center; gap: 8px; background: rgba(255,255,255,0.1); padding: 8px 15px; border-radius: 20px; font-size: 14px;">
                            <span style="color: #10b981;">‚óè</span>
                            <span style="color: white;">ONLINE</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 8px; background: rgba(255,255,255,0.1); padding: 8px 15px; border-radius: 20px; font-size: 14px;">
                            <span style="color: #f59e0b;">üîã</span>
                            <span style="color: white;">85%</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 8px; background: rgba(255,255,255,0.1); padding: 8px 15px; border-radius: 20px; font-size: 14px;">
                            <span style="color: #3b82f6;">üìç</span>
                            <span style="color: white;">GPS ACTIVE</span>
                        </div>
                    </div>
                </div>

                <!-- Main Container -->
                <div style="display: grid; grid-template-columns: 1fr 350px; height: calc(100vh - 70px); gap: 0;">
                    <!-- Map Section -->
                    <div style="position: relative; background: #1e293b;">
                        <div style="width: 100%; height: 100%; position: relative;">
                            <div id="map" style="width: 100%; height: 100%;"></div>
                            
                            <!-- Map Controls -->
                            <div style="position: absolute; top: 20px; left: 20px; z-index: 1000; display: flex; flex-direction: column; gap: 10px;">
                                <button onclick="centerOnDevice()" style="background: rgba(15, 23, 42, 0.9); color: white; border: none; padding: 12px; border-radius: 8px; cursor: pointer; font-size: 14px; font-weight: 600; transition: all 0.3s ease; backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.1);">üìç Center on Device</button>
                                <button onclick="toggleTracking()" style="background: rgba(15, 23, 42, 0.9); color: white; border: none; padding: 12px; border-radius: 8px; cursor: pointer; font-size: 14px; font-weight: 600; transition: all 0.3s ease; backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.1);">üéØ Live Tracking</button>
                                <button onclick="showRoute()" style="background: rgba(15, 23, 42, 0.9); color: white; border: none; padding: 12px; border-radius: 8px; cursor: pointer; font-size: 14px; font-weight: 600; transition: all 0.3s ease; backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.1);">üõ£Ô∏è Show Route</button>
                            </div>

                            <!-- Tracking Info -->
                            <div style="position: absolute; bottom: 20px; left: 20px; background: rgba(15, 23, 42, 0.95); padding: 20px; border-radius: 12px; backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.1); min-width: 300px;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                    <strong style="color: white;">üéØ Live Tracking</strong>
                                    <span style="font-size: 12px; opacity: 0.7; color: white;">Live</span>
                                </div>
                                <div id="coordinates" style="color: white; font-family: monospace;">37.9755¬∞N, 23.7348¬∞E</div>
                                <div style="font-size: 12px; opacity: 0.7; margin-top: 8px; color: white;">
                                    Speed: <span id="currentSpeed">0 km/h</span> | 
                                    Accuracy: <span id="gpsAccuracy">¬±3m</span>
                                </div>
                                <div style="font-size: 12px; margin-top: 8px; padding: 8px; background: rgba(239,68,68,0.2); border-radius: 6px; color: white;">
                                    ‚è±Ô∏è Time at location: <span id="timeAtLocation">0m 0s</span><br>
                                    üë£ Steps taken: <span id="stepCount">0</span> | Distance: <span id="totalDistance">0m</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Control Panel -->
                    <div style="background: linear-gradient(180deg, #1e293b, #0f172a); padding: 20px; overflow-y: auto; border-left: 1px solid rgba(255,255,255,0.1);">
                        <!-- User Info -->
                        <div style="margin-bottom: 30px;">
                            <div style="color: #e2e8f0; font-size: 1.2rem; font-weight: 700; margin-bottom: 15px; display: flex; align-items: center; gap: 10px;">
                                üë§ User Session
                            </div>
                            <div style="background: rgba(255,255,255,0.05); padding: 20px; border-radius: 12px; border: 1px solid rgba(255,255,255,0.1);">
                                <div style="color: white; font-weight: 600; margin-bottom: 5px;">${email}</div>
                                <div style="font-size: 12px; opacity: 0.7; color: white;">PIN verified via mobile app</div>
                            </div>
                        </div>

                        <!-- Security Controls -->
                        <div style="margin-bottom: 30px;">
                            <div style="color: #e2e8f0; font-size: 1.2rem; font-weight: 700; margin-bottom: 15px; display: flex; align-items: center; gap: 10px;">
                                üîí Security Controls
                            </div>
                            <div style="display: grid; gap: 12px;">
                                <button onclick="lockDevice()" style="background: linear-gradient(135deg, #3b82f6, #1d4ed8); color: white; border: none; padding: 15px; border-radius: 10px; cursor: pointer; font-weight: 600; transition: all 0.3s ease; display: flex; align-items: center; gap: 10px; justify-content: center;">
                                    üîí Lock Device
                                </button>
                                <button onclick="soundAlarm()" style="background: linear-gradient(135deg, #f59e0b, #d97706); color: white; border: none; padding: 15px; border-radius: 10px; cursor: pointer; font-weight: 600; transition: all 0.3s ease; display: flex; align-items: center; gap: 10px; justify-content: center;">
                                    üö® Sound Alarm
                                </button>
                                <button onclick="takePhoto()" style="background: linear-gradient(135deg, #10b981, #059669); color: white; border: none; padding: 15px; border-radius: 10px; cursor: pointer; font-weight: 600; transition: all 0.3s ease; display: flex; align-items: center; gap: 10px; justify-content: center;">
                                    üì∏ Capture Photo
                                </button>
                                <button onclick="wipeData()" style="background: linear-gradient(135deg, #ef4444, #dc2626); color: white; border: none; padding: 15px; border-radius: 10px; cursor: pointer; font-weight: 600; transition: all 0.3s ease; display: flex; align-items: center; gap: 10px; justify-content: center;">
                                    üóëÔ∏è Wipe Data
                                </button>
                            </div>
                        </div>

                        <!-- Logout -->
                        <button onclick="logout()" style="background: linear-gradient(135deg, #6b7280, #4b5563); color: white; border: none; padding: 15px; border-radius: 10px; cursor: pointer; font-weight: 600; width: 100%; margin-top: 20px;">
                            üö™ Sign Out
                        </button>
                    </div>
                </div>

                <!-- Leaflet CSS and JS -->
                <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
                <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
            `;
            
            // Initialize full-screen map
            setTimeout(() => {
                initializeFullScreenMap();
            }, 100);
        }

        // Initialize full-screen advanced map
        function initializeFullScreenMap() {
            if (map) {
                map.remove(); // Remove existing map
            }
            
            // Create map with higher zoom for better detail
            map = L.map('map').setView([currentLat, currentLng], 18);
            
            // Add tile layer
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '¬© OpenStreetMap contributors'
            }).addTo(map);
            
            // Advanced device marker with pulsing effect
            const deviceIcon = L.divIcon({
                html: '<div style="background: #ef4444; width: 20px; height: 20px; border-radius: 50%; border: 3px solid white; box-shadow: 0 0 10px rgba(239,68,68,0.5); animation: pulse 2s infinite;"></div>',
                iconSize: [20, 20],
                className: 'device-marker'
            });
            
            deviceMarker = L.marker([currentLat, currentLng], { icon: deviceIcon }).addTo(map);
            
            // Add popup to marker
            const popupTexts = {
                en: '<b>üì± Target Device</b><br>Status: Active<br>Battery: 85%<br>Signal: Strong',
                el: '<b>üì± Œ£œÖœÉŒ∫ŒµœÖŒÆ Œ£œÑœåœáŒøœÇ</b><br>ŒöŒ±œÑŒ¨œÉœÑŒ±œÉŒ∑: ŒïŒΩŒµœÅŒ≥ŒÆ<br>ŒúœÄŒ±œÑŒ±œÅŒØŒ±: 85%<br>Œ£ŒÆŒºŒ±: ŒôœÉœáœÖœÅœå',
                ar: '<b>üì± ÿßŸÑÿ¨Ÿáÿßÿ≤ ÿßŸÑŸÖÿ≥ÿ™ŸáÿØŸÅ</b><br>ÿßŸÑÿ≠ÿßŸÑÿ©: ŸÜÿ¥ÿ∑<br>ÿßŸÑÿ®ÿ∑ÿßÿ±Ÿäÿ©: 85%<br>ÿßŸÑÿ•ÿ¥ÿßÿ±ÿ©: ŸÇŸàŸäÿ©'
            };
            
            deviceMarker.bindPopup(popupTexts[currentLanguage]).openPopup();
            
            // Start advanced tracking
            startAdvancedTracking();
        }

        // Calculate distance between two points
        function calculateDistance(lat1, lng1, lat2, lng2) {
            const R = 6371e3; // Earth's radius in meters
            const œÜ1 = lat1 * Math.PI/180;
            const œÜ2 = lat2 * Math.PI/180;
            const ŒîœÜ = (lat2-lat1) * Math.PI/180;
            const ŒîŒª = (lng2-lng1) * Math.PI/180;

            const a = Math.sin(ŒîœÜ/2) * Math.sin(ŒîœÜ/2) +
                      Math.cos(œÜ1) * Math.cos(œÜ2) *
                      Math.sin(ŒîŒª/2) * Math.sin(ŒîŒª/2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));

            return R * c; // Distance in meters
        }

        // Advanced tracking simulation
        function startAdvancedTracking() {
            setInterval(() => {
                if (!isTracking) return;
                
                const currentPos = deviceMarker.getLatLng();
                
                // Realistic movement simulation
                const movementChance = Math.random();
                let newLat = currentPos.lat;
                let newLng = currentPos.lng;
                let speed = 0;
                
                if (movementChance > 0.3) { // 70% chance of movement
                    const moveDistance = Math.random() * 0.0001; // Realistic steps
                    const direction = Math.random() * 2 * Math.PI;
                    
                    newLat += Math.cos(direction) * moveDistance;
                    newLng += Math.sin(direction) * moveDistance;
                    
                    // Calculate distance and speed
                    const distanceMoved = calculateDistance(currentPos.lat, currentPos.lng, newLat, newLng);
                    totalDistance += distanceMoved;
                    speed = Math.floor((distanceMoved / 1000) * 3600); // km/h
                    if (speed < 1) speed = Math.floor(Math.random() * 5) + 1;
                    
                    isMoving = true;
                } else {
                    speed = 0;
                    isMoving = false;
                }
                
                // Update position
                deviceMarker.setLatLng([newLat, newLng]);
                trackingPath.push([newLat, newLng]);
                currentLat = newLat;
                currentLng = newLng;
                
                // Update displays
                document.getElementById('coordinates').textContent = 
                    `${newLat.toFixed(6)}¬∞N, ${newLng.toFixed(6)}¬∞E`;
                document.getElementById('currentSpeed').textContent = `${speed} km/h`;
                document.getElementById('totalDistance').textContent = `${Math.floor(totalDistance)}m`;
                
                // Update GPS accuracy
                const accuracy = isMoving ? Math.floor(Math.random() * 5) + 3 : Math.floor(Math.random() * 2) + 1;
                document.getElementById('gpsAccuracy').textContent = `¬±${accuracy}m`;
                
                // Update tracking time
                const trackingTime = Math.floor((Date.now() - trackingStartTime) / 1000);
                const minutes = Math.floor(trackingTime / 60);
                const seconds = trackingTime % 60;
                document.getElementById('trackingTime').textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                
            }, 1000); // Update every second for smooth tracking
        }

        // Map control functions
        function centerOnDevice() {
            if (map && deviceMarker) {
                map.setView(deviceMarker.getLatLng(), 18);
            }
        }

        function toggleTracking() {
            isTracking = !isTracking;
            const btn = event.target;
            
            if (isTracking) {
                btn.textContent = '‚èπÔ∏è Stop';
                btn.style.background = 'rgba(239, 68, 68, 0.8)';
            } else {
                btn.textContent = 'üéØ Track';
                btn.style.background = 'rgba(255,255,255,0.1)';
            }
        }

        // Dashboard functions
        function lockDevice() {
            const messages = {
                en: 'üîí Device locked successfully!',
                el: 'üîí Œó œÉœÖœÉŒ∫ŒµœÖŒÆ Œ∫ŒªŒµŒπŒ¥œéŒ∏Œ∑Œ∫Œµ ŒµœÄŒπœÑœÖœáœéœÇ!',
                ar: 'üîí ÿ™ŸÖ ŸÇŸÅŸÑ ÿßŸÑÿ¨Ÿáÿßÿ≤ ÿ®ŸÜÿ¨ÿßÿ≠!'
            };
            showMessage(messages[currentLanguage], 'success');
        }

        function soundAlarm() {
            const messages = {
                en: 'üö® Alarm activated!',
                el: 'üö® Œü œÉœÖŒΩŒ±Œ≥ŒµœÅŒºœåœÇ ŒµŒΩŒµœÅŒ≥ŒøœÄŒøŒπŒÆŒ∏Œ∑Œ∫Œµ!',
                ar: 'üö® ÿ™ŸÖ ÿ™ŸÅÿπŸäŸÑ ÿßŸÑÿ•ŸÜÿ∞ÿßÿ±!'
            };
            showMessage(messages[currentLanguage], 'success');
        }

        // Additional map functions
        function showRoute() {
            if (trackingPath.length > 1) {
                L.polyline(trackingPath, {color: '#ef4444', weight: 3}).addTo(map);
                alert('üõ£Ô∏è Route displayed on map');
            } else {
                alert('‚ö†Ô∏è No route data available');
            }
        }

        function takePhoto() {
            alert('üì∏ Photo captured from front camera');
        }

        function wipeData() {
            const messages = {
                en: 'üóëÔ∏è Data wipe initiated! (This is a demo)',
                el: 'üóëÔ∏è Œó Œ¥ŒπŒ±Œ≥œÅŒ±œÜŒÆ Œ¥ŒµŒ¥ŒøŒºŒ≠ŒΩœâŒΩ ŒæŒµŒ∫ŒØŒΩŒ∑œÉŒµ! (ŒëœÖœÑœå ŒµŒØŒΩŒ±Œπ demo)',
                ar: 'üóëÔ∏è ÿ®ÿØÿ£ ŸÖÿ≥ÿ≠ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™! (Ÿáÿ∞ÿß ÿπÿ±ÿ∂ ÿ™Ÿàÿ∂Ÿäÿ≠Ÿä)'
            };
            showMessage(messages[currentLanguage], 'success');
        }

        function logout() {
            location.reload(); // Reload page to return to login
        }



        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            setLanguage('en');
            document.getElementById('email').focus();
        });
    </script>
</body>
</html>